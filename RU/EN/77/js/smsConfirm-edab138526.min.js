var chlenruslana=1;define(["ajax"],(function(t){return{init:function(){this.actionToPost="/profile/smsconfirm",this.container=document.querySelector("[sms-confirm-container]"),this.container&&App.context.sms_verification_status&&(this.formPhone=this.container.querySelector("#sms-c-phone"),this.formValidate=this.container.querySelector("#sms-c-validate"),this.btnResend=this.container.querySelector("#sms-c-resend"),this.formSupport=document.querySelector(".sms-c-help-form"),this.inited=!0,this.status=App.context.sms_verification_status||"init",this.container.style.display="block",this.showStep(),this.bind())},bind:function(){var t=this;this.formSupport&&(this.formSupport.onsubmit=this.supportFormSubmit.bind(this)),this.formPhone&&(this.formPhone.onsubmit=this.formPhoneSubmit.bind(this)),this.formValidate&&(this.formValidate.onsubmit=this.formValidateSubmit.bind(this)),this.btnResend&&(this.btnResend.onclick=this.btnResendClick.bind(this));var e=Q(".sms-c .need-help");[].forEach.call(e,(function(e){e.onclick=t.helpButtonClick.bind(t)}));var s=Q(".back-button")[0];s&&(s.onclick=this.showStep.bind(this))},supportFormSubmit:function(e){e.preventDefault();var s=e.target,i=s.topic.value,o=s.getAttribute("action"),n=s.message.value,r=s.querySelector(".sms-c-btn"),c=document.querySelector(".sms-c-help-error");c&&(c.textContent="",c.style.display="none"),r.classList.contains("disabled")||(r.classList.add("disabled"),t.post(o,{message:n,topic:i},(function(t){if(r.classList.remove("disabled"),t){if(t.error)return void(c&&(c.textContent=t.error,c.style.display="block"));var e=s.querySelector(".success");r&&e&&(r.classList.add("hidden"),e.classList.remove("hidden"))}})))},helpButtonClick:function(t){t.preventDefault();var e=document.querySelectorAll("[sms-c-step-step]");[].forEach.call(e,(function(t){t.style.display="none"})),this.formSupport.style.display="block";var s=document.querySelector(".sms-c-help-error"),i=this.formSupport.querySelector(".sms-c-btn"),o=this.formSupport.querySelector(".success");i&&o&&(o.classList.add("hidden"),i.classList.remove("hidden")),s&&(s.textContent="",s.style.display="none")},formPhoneSubmit:function(e){var s=this;e.preventDefault(),e.stopPropagation();var i=e.target,o={phone:i.querySelector('[name="phone"]').value,country:i.querySelector('[name="country"]').options[i.querySelector('[name="country"]').selectedIndex].value};if(o.phone){var n=i.querySelector(".sms-c-error");n.innerHTML="",n.style.display="none",t.post(this.actionToPost,o,(function(t){if(t){if(t.error)return n.innerHTML=t.error_message||"error",void(n.style.display="block");s.status="sent",s.showStep()}}))}},formValidateSubmit:function(e){var s=this;e.preventDefault(),e.stopPropagation();var i=e.target,o={validate:1,digits:i.querySelector('[name="digits"]').value};if(o.digits){var n=i.querySelector(".sms-c-error");n.innerHTML="",n.style.display="none",t.post(this.actionToPost,o,(function(t){if(t){if(t.error)return n.innerHTML=t.error_message||"error",void(n.style.display="block");s.container.parentNode.removeChild(s.container),App.context.sms_verification_status=!1}}))}},btnResendClick:function(t){t.preventDefault(),t.stopPropagation(),this.status="init",this.showStep()},showStep:function(){switch(this.formSupport&&(this.formSupport.style.display="none"),this.status){case"init":this.container.querySelector('[sms-c-step-step="sent"]').style.display="none",this.container.querySelector('[sms-c-step-step="init"]').style.display="block",this.formPhone.querySelector('[name="phone"]').focus();break;case"sent":this.container.querySelector('[sms-c-step-step="init"]').style.display="none",this.container.querySelector('[sms-c-step-step="sent"]').style.display="block",this.formValidate.querySelector('[name="digits"]').focus()}}}}));
//# sourceMappingURL=smsConfirm-edab138526.min.js.map
